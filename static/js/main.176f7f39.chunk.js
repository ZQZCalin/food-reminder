(this["webpackJsonpfood-reminder"]=this["webpackJsonpfood-reminder"]||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(21),o=n.n(r),i=(n(96),n(42)),s=n(14),l=n(15),j=n(22),u=n.n(j),d=n(3);var b=function(e){var t=e.category;return Object(d.jsx)("div",{className:u.a.header,style:{color:t.textColor,backgroundColor:t.color},children:t.name})};var m=function(e){var t=""+(e.getMonth()+1),n=""+e.getDate(),c=""+e.getFullYear();return t.length<2&&(t="0"+t),n.length<2&&(n="0"+n),[c,t,n].join("-")},x=n(75),h=n.n(x),O=[{name:"\u6c34\u679c",id:"fruits",color:"#42a5f5",textColor:"#f5f5f5"},{name:"\u852c\u83dc",id:"vegetables",color:"#8bc34a",textColor:"#f5f5f5"},{name:"\u8089\u7c7b",id:"meat",color:"#FF5722",textColor:"#f5f5f5"},{name:"\u5e72\u8d27",id:"dry-foods",color:"#FEA82F",textColor:"#f5f5f5"},{name:"\u5176\u4ed6",id:"others",color:"#cfd8dc",textColor:"#757575"}],f=8.64*Math.pow(10,7);function g(e,t){return Math.floor((new Date(e).getTime()-new Date(t).getTime())/f)}var v=n(80),p=n.n(v),_=n(79),C=n.n(_),D=n(138),y=n(141),w=n(136),I=n(137),S=Object(c.createContext)();var N=function(e){var t=Object(c.useState)(""),n=Object(l.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(""),i=Object(l.a)(o,2),s=i[0],j=i[1],u=Object(c.useState)(""),b=Object(l.a)(u,2),x=b[0],h=b[1],O=Object(c.useState)(""),f=Object(l.a)(O,2),v=f[0],p=f[1],_=Object(c.useState)(m(new Date)),C=Object(l.a)(_,2),D=C[0],y=C[1],w=Object(c.useState)(0),I=Object(l.a)(w,2),N=I[0],T=I[1],k=function(e){var t=e._id,n=e._name,c=e._category,a=e._expireDate,o=e._comment;r(t),j(n),h(c),p(o),y(a),T(g(a,m(new Date)))};return Object(d.jsx)(S.Provider,{value:{id:a,setId:r,name:s,setName:j,category:x,setCategory:h,comment:v,setComment:p,expireDate:D,setExpireDate:y,expireInDays:N,setExpireInDays:T,setNewItem:k,resetNewItem:function(){k({_id:"",_name:"",_category:"",_expireDate:m(new Date),_comment:""})}},children:e.children})};function T(e,t){var n=new Date(e).getTime()-new Date(t).getTime();return n<0?-1:n>0?1:0}var k=n(52),B=n(64),F=n.n(B),P=n(62);n(100),n(101);P.a.initializeApp({apiKey:"AIzaSyBB3M2bTBga_ZlUO_Y266AIZwUS5emMmCM",authDomain:"food-reminder-e1c8b.firebaseapp.com",projectId:"food-reminder-e1c8b",storageBucket:"food-reminder-e1c8b.appspot.com",messagingSenderId:"209486423857",appId:"1:209486423857:web:ae03d94e05722b23a37210"});var E=P.a.auth(),M=P.a.firestore(),A=Object(c.createContext)();var H=function(e){var t=Object(s.g)(),n=Object(c.useContext)(U),a=n.userData,r=n.setUserData,o=n.setCurrentUser;return E.onAuthStateChanged((function(e){e&&!a?M.collection("users").where("userId","==",e.uid).get().then((function(n){n.docs[0].ref.collection("items").get().then((function(n){o(e.uid),r(n.docs.map((function(e){return e.data()}))),t.push("./home")}))})).catch((function(e){alert("Database Error: "+e)})):!e&&a&&r(null)})),Object(c.useEffect)((function(){var e=setTimeout((function(){a||t.push("./login")}),500);return function(){clearTimeout(e)}}),[a]),Object(d.jsx)(A.Provider,{value:{login:function(e,t){E.signInWithEmailAndPassword(e,t).catch((function(e){alert("Login Error: "+e)}))}},children:e.children})},U=Object(c.createContext)();var z=function(e){var t=Object(c.useState)(null),n=Object(l.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(""),i=Object(l.a)(o,2),j=i[0],u=i[1];return Object(s.g)().history,Object(d.jsx)(U.Provider,{value:{currentUser:j,setCurrentUser:u,userData:a,setUserData:r,addItem:function(e){M.collection("users").where("userId","==",j).get().then((function(t){t.docs[0].ref.collection("items").add(e).then((function(){console.log("successfully ADD new item"),r(a.concat([e]))}))}))},deleteItem:function(e){M.collection("users").where("userId","==",j).get().then((function(t){t.docs[0].ref.collection("items").where("id","==",e.id).get().then((function(t){t.docs[0].ref.delete().then((function(){console.log("successfully DELETE new item"),r(a.filter((function(t){return t.id!==e.id})))}))}))}))},editItem:function(e){M.collection("users").where("userId","==",j).get().then((function(t){t.docs[0].ref.collection("items").where("id","==",e.id).get().then((function(t){t.docs[0].ref.update(Object(k.a)({},e)).then((function(){console.log("successfully EDIT new item"),r(a.map((function(t){return t.id!==e.id?t:e})))}))}))}))}},children:e.children})},Y=Object(c.createContext)();function L(){var e=Object(c.useContext)(Y),t=e.open,n=e.setOpen,a=e.handleDelete,r=function(){n(!1)};return Object(d.jsxs)(D.a,{open:t,onClose:r,children:[Object(d.jsx)(y.a,{children:"\u786e\u8ba4\u5220\u9664\uff1f"}),Object(d.jsx)(w.a,{children:"\u662f\u5426\u8981\u5220\u9664\u8fd9\u9879\u7269\u54c1\uff1f\u4e00\u65e6\u786e\u8ba4\uff0c\u8be5\u7269\u54c1\u5c06\u88ab\u6c38\u4e45\u5220\u9664\u3002"}),Object(d.jsxs)(I.a,{children:[Object(d.jsx)("div",{onClick:r,className:u.a.dialogCancelBtn,children:"\u53d6\u6d88"}),Object(d.jsx)("div",{onClick:a,className:u.a.dialogConfirmBtn,children:"\u786e\u8ba4"})]})]})}var G=function(e){var t,n=e.item,a=Object(s.g)(),r=Object(c.useContext)(V),o=r.focus,i=r.setFocus,j=Object(c.useContext)(S).setNewItem,b=Object(c.useState)(!1),x=Object(l.a)(b,2),f=x[0],v=x[1],_=Object(c.useContext)(U).deleteItem,D=O.find((function(e){return e.id===n.category})),y=g(n.expireDate,m(new Date)),w=y<0;t=w||y<=3?"#c23b0a":y<=7?"#cf9911":"#2b9611";var I=D.color;return Object(d.jsx)(Y.Provider,{value:{open:f,setOpen:v,handleDelete:function(){_(n),v(!1)}},children:Object(d.jsxs)("div",{className:u.a.itemTag,onClick:function(){return i(n.id)},style:{borderColor:I,boxShadow:w?"3px 3px 8px #c23b0a":"3px 3px 8px #cfcfcf"},children:[Object(d.jsx)("div",{className:u.a.itemTagName,children:n.name}),Object(d.jsxs)("div",{className:u.a.itemTagTime,style:{color:w?"red":"inherit"},children:[Object(d.jsx)(h.a,{style:{color:t}}),w?"\u5df2\u7ecf\u8fc7\u671f":y<=7?"".concat(y," \u5929\u540e\u8fc7\u671f"):"".concat(n.expireDate," \u8fc7\u671f")]}),n.id===o&&n.comment&&""!==n.comment&&Object(d.jsxs)("div",{className:u.a.itemTagComment,children:[" ",n.comment," "]}),n.id===o&&Object(d.jsxs)("div",{className:u.a.itemTagMore,children:[Object(d.jsx)(C.a,{style:{color:"#43a047"},onClick:function(){j({_id:n.id,_name:n.name,_category:n.category,_expireDate:n.expireDate,_comment:n.comment}),a.push("./new-item")}}),Object(d.jsx)(p.a,{color:"secondary",style:{marginLeft:"5px"},onClick:function(){v(!0)}})]}),Object(d.jsx)(L,{})]})})},J=n(68),R=n.n(J),Z=n(81),q=n.n(Z);var K=function(){var e=Object(s.g)(),t=Object(c.useContext)(W),n=t.search,a=t.setSearch,r=t.sort,o=t.setSort,i=Object(c.useContext)(S).resetNewItem;return Object(d.jsxs)("div",{className:u.a.toolbar,children:[Object(d.jsx)("input",{placeholder:"\u641c\u7d22",value:n,onChange:function(e){a(e.target.value)}}),Object(d.jsxs)("div",{className:u.a.toolbarToggle,children:[Object(d.jsx)("input",{type:"checkbox",id:u.a.toolbarCheckbox,value:r,onChange:function(){o(!r)}}),Object(d.jsx)("label",{htmlFor:u.a.toolbarCheckbox,children:"\u7d27\u51d1\u6a21\u5f0f"})]}),Object(d.jsxs)("div",{onClick:function(){i(),e.push("./new-item")},style:{display:"flex",alignItems:"center",fontSize:"0.9em",position:"absolute",right:"12px"},children:[Object(d.jsx)(q.a,{style:{marginRight:"3px"}})," \u6dfb\u52a0\u9879\u76ee"]})]})};var Q=function(){return Object(d.jsx)("div",{children:"\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u7a0d\u7b49\u2026\u2026"})},W=Object(c.createContext)(),V=Object(c.createContext)();var X=function(){var e=Object(c.useContext)(U).userData,t=Object(c.useState)(""),n=Object(l.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(""),i=Object(l.a)(o,2),s=i[0],j=i[1],u=Object(c.useState)(!1),m=Object(l.a)(u,2),x=m[0],h=m[1];return e?Object(d.jsx)(W.Provider,{value:{search:s,setSearch:j,sort:x,setSort:h},children:Object(d.jsxs)(V.Provider,{value:{focus:a,setFocus:r},children:[Object(d.jsx)(K,{}),x?Object(d.jsx)("div",{children:e.filter((function(e){return e.name.includes(s)||R()(e.name,{removeTone:!0,removeSpace:!1}).includes(s)})).sort((function(e,t){return T(e.expireDate,t.expireDate)})).map((function(e){return Object(d.jsx)(G,{item:e},e.id)}))}):Object(d.jsx)("div",{children:O.map((function(t){return Object(d.jsxs)("div",{children:[Object(d.jsx)(b,{category:t}),e.filter((function(e){return e.category===t.id})).filter((function(e){return e.name.includes(s)||R()(e.name,{removeTone:!0,removeSpace:!1}).includes(s)})).sort((function(e,t){return T(e.expireDate,t.expireDate)})).map((function(e){return Object(d.jsx)(G,{item:e},e.id)}))]},t.id)}))})]})}):Object(d.jsx)(Q,{})};var $=function(){return Object(d.jsx)("div",{children:"Account"})},ee=n(26),te=n.n(ee),ne=n(84),ce=n.n(ne),ae=(n(111),n(139)),re=8.64*Math.pow(10,7),oe=6*Math.pow(10,4),ie=(new Date).getTimezoneOffset();var se=n(85),le=n.n(se),je=n(86),ue=n.n(je),de=n(140);var be=function(){var e=Object(s.g)(),t=Object(c.useContext)(U).userData,n=Object(c.useContext)(U),a=n.addItem,r=n.editItem,o=Object(c.useContext)(S),i=o.id,j=(o.setId,o.name),b=o.setName,x=o.category,h=o.setCategory,f=o.comment,v=o.setComment,p=o.expireDate,_=o.setExpireDate,C=o.expireInDays,D=o.setExpireInDays,y=o.resetNewItem,w=Object(c.useState)(!1),I=Object(l.a)(w,2),N=I[0],B=I[1];return t?Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:u.a.toolbar,children:Object(d.jsxs)("div",{className:te.a.headerBackBtn,onClick:function(){e.push("./home")},children:[Object(d.jsx)(ce.a,{})," \u8fd4\u56de"]})}),Object(d.jsxs)("form",{className:te.a.form,children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{htmlFor:te.a.name,children:"\u540d\u79f0"})," ",Object(d.jsx)("br",{}),Object(d.jsx)("input",{id:te.a.name,className:te.a.formInput,value:j,onChange:function(e){b(e.target.value)}})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{htmlFor:te.a.category,children:"\u5206\u7c7b"})," ",Object(d.jsx)("br",{}),Object(d.jsxs)("select",{id:te.a.category,value:x,onChange:function(e){h(e.target.value)},children:[Object(d.jsx)("option",{value:"",children:"----- \u8bf7\u9009\u62e9\u5206\u7c7b -----"}),O.map((function(e){return Object(d.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(d.jsx)("label",{children:"\u4fdd\u8d28\u671f"}),Object(d.jsxs)("div",{id:te.a.toggleDiv,children:[Object(d.jsx)("input",{id:"toggle",type:"checkbox",value:N,onChange:function(){B(!N)}}),Object(d.jsx)("label",{htmlFor:"toggle",children:"\u9009\u53d6\u65e5\u671f"})]})]}),N?Object(d.jsx)("input",{id:te.a.expireDate,type:"date",value:p,onChange:function(e){_(e.target.value),D(g(e.target.value,m(new Date)))}}):Object(d.jsxs)("div",{style:{textAlign:"center"},children:[Object(d.jsx)("input",{id:te.a.expireInDays,type:"number",value:C,onChange:function(e){var t,n;D(e.target.value),_((t=m(new Date),n=e.target.value,m(new Date(new Date(t).getTime()+n*re+ie*oe))))}}),Object(d.jsx)("label",{htmlFor:te.a.expireInDays,children:" \u5929\u540e\u8fc7\u671f"})]})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("label",{htmlFor:te.a.comment,children:"\u5907\u6ce8"})," ",Object(d.jsx)("br",{}),Object(d.jsx)("textarea",{id:te.a.comment,rows:3,value:f,onChange:function(e){v(e.target.value)}})]}),Object(d.jsxs)("div",{className:te.a.formSubmit,children:[Object(d.jsxs)(ae.a,{style:{fontSize:"1rem",color:"red"},onClick:y,children:[Object(d.jsx)(le.a,{}),"\u6e05\u9664"]}),Object(d.jsxs)(ae.a,{variant:"contained",style:{fontSize:"1rem",color:"#F0F0F0",backgroundColor:"#B05B3B"},onClick:function(){var t={id:i,name:j,category:x,expireDate:p,comment:f},n=[];if(""===j&&n.push("\u8bf7\u8f93\u5165\u540d\u5b57"),""===x&&n.push("\u8bf7\u9009\u62e9\u79cd\u7c7b"),-1==T(p,m(new Date))&&n.push("\u8fc7\u671f\u65e5\u671f\u4e0d\u80fd\u4e3a\u8fc7\u53bb\u7684\u65e5\u671f"),0!=n.length)return alert(n.join("\n")),null;""===i?a(Object(k.a)(Object(k.a)({},t),{},{id:Object(de.a)()})):r(t),y(),e.push("./home")},children:[Object(d.jsx)(ue.a,{style:{marginRight:"0.15em"}}),"\u4fdd\u5b58"]})]})]})]}):Object(d.jsx)(Q,{})};var me=function(){var e=Object(c.useContext)(A).login,t=Object(c.useState)(""),n=Object(l.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(""),i=Object(l.a)(o,2),s=i[0],j=i[1];return Object(d.jsx)("div",{className:F.a.login,children:Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{children:"\u767b\u5f55"}),Object(d.jsxs)("div",{children:["\u90ae\u7bb1\uff1a",Object(d.jsx)("input",{value:a,onChange:function(e){r(e.target.value)}})]}),Object(d.jsxs)("div",{children:["\u5bc6\u7801\uff1a",Object(d.jsx)("input",{type:"password",value:s,onChange:function(e){j(e.target.value)}})]}),Object(d.jsx)("button",{onClick:function(){e(a,s)},children:"\u786e\u5b9a"})]})})};var xe=function(){return Object(d.jsx)(i.a,{basename:"/food-reminder",children:Object(d.jsx)(z,{children:Object(d.jsx)(H,{children:Object(d.jsx)(N,{children:Object(d.jsxs)(s.d,{children:[Object(d.jsx)(s.b,{path:"/home",children:Object(d.jsx)(X,{})}),Object(d.jsx)(s.b,{path:"/new-item",children:Object(d.jsx)(be,{})}),Object(d.jsx)(s.b,{path:"/account",children:Object(d.jsx)($,{})}),Object(d.jsx)(s.b,{path:"/login",children:Object(d.jsx)(me,{})}),Object(d.jsx)(s.b,{path:"/",children:Object(d.jsx)(s.a,{to:"/login"})})]})})})})})};o.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(xe,{})}),document.getElementById("root"))},22:function(e,t,n){e.exports={itemTag:"Home_itemTag__2tM5m",itemTagTime:"Home_itemTagTime__3MI3S",itemTagComment:"Home_itemTagComment__1haJH",itemTagMore:"Home_itemTagMore__ovSbv",toolbar:"Home_toolbar__3AGqh",toolbarToggle:"Home_toolbarToggle__2oSg7",toolbarCheckbox:"Home_toolbarCheckbox__3HxwP",header:"Home_header__31p1I",dialogCancelBtn:"Home_dialogCancelBtn__2OS-A",dialogConfirmBtn:"Home_dialogConfirmBtn__3bM_B"}},26:function(e,t,n){e.exports={headerBackBtn:"NewPage_headerBackBtn__1Gbkn",form:"NewPage_form__1OlwF",toggleDiv:"NewPage_toggleDiv__2rY4A",formSubmit:"NewPage_formSubmit__14eAv",name:"NewPage_name__3yGes",category:"NewPage_category__3YlE6",expireInDays:"NewPage_expireInDays__32Y4v",expireDate:"NewPage_expireDate__2knjQ",comment:"NewPage_comment__37k5I"}},64:function(e,t,n){e.exports={login:"Login_login__3menE"}},96:function(e,t,n){}},[[112,1,2]]]);
//# sourceMappingURL=main.176f7f39.chunk.js.map